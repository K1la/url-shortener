# URL Shortener

ะกะตัะฒะธั ัะพะบัะฐัะตะฝะธั URL ั ะฐะฝะฐะปะธัะธะบะพะน ะฟะตัะตัะพะดะพะฒ. ะกะพะทะดะฐะฒะฐะนัะต ะบะพัะพัะบะธะต ัััะปะบะธ, ะพััะปะตะถะธะฒะฐะนัะต ััะฐัะธััะธะบั ะธ ะฐะฝะฐะปะธะทะธััะนัะต ะฟะตัะตัะพะดั ะฟะพะปัะทะพะฒะฐัะตะปะตะน.

## ๐ ะะพะทะผะพะถะฝะพััะธ

- **ะกะพะทะดะฐะฝะธะต ะบะพัะพัะบะธั ัััะปะพะบ**: ะะฒัะพะผะฐัะธัะตัะบะฐั ะณะตะฝะตัะฐัะธั ะธะปะธ ะบะฐััะพะผะฝัะต ะฐะปะธะฐัั
- **ะะตะดะธัะตะบั**: ะะตัะตัะพะดั ะฟะพ ะบะพัะพัะบะธะผ ัััะปะบะฐะผ ั ัะพััะฐะฝะตะฝะธะตะผ ะฐะฝะฐะปะธัะธะบะธ
- **ะะฝะฐะปะธัะธะบะฐ**: ะะพะดัะพะฑะฝะฐั ััะฐัะธััะธะบะฐ ะฟะตัะตัะพะดะพะฒ ะฟะพ ะดะฝัะผ/ะผะตัััะฐะผ
- **ะกะพะฒัะตะผะตะฝะฝัะน UI**: ะขะตะผะฝะฐั ัะตะผะฐ ั ะฐะดะฐะฟัะธะฒะฝัะผ ะดะธะทะฐะนะฝะพะผ
- **ะััะธัะพะฒะฐะฝะธะต**: Redis ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ ะบ ะดะฐะฝะฝัะผ
- **ะะฐะทะฐ ะดะฐะฝะฝัั**: PostgreSQL ะดะปั ะฝะฐะดะตะถะฝะพะณะพ ััะฐะฝะตะฝะธั

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- Docker & Docker Compose
- Go 1.24+ (ะดะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ)
- Node.js (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะดะปั ััะพะฝัะตะฝะดะฐ)

## ๐๏ธ ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ

```
url-shortener/
โโโ cmd/
โ   โโโ shortener/
โ       โโโ main.go                 # ะขะพัะบะฐ ะฒัะพะดะฐ ะฟัะธะปะพะถะตะฝะธั
โโโ internal/
โ   โโโ api/
โ   โ   โโโ handler/                # HTTP ะพะฑัะฐะฑะพััะธะบะธ
โ   โ   โ   โโโ create.go          # ะกะพะทะดะฐะฝะธะต ะบะพัะพัะบะธั ัััะปะพะบ
โ   โ   โ   โโโ get.go             # ะะพะปััะตะฝะธะต ะธ ัะตะดะธัะตะบั
โ   โ   โ   โโโ handler.go         # ะะฐะทะพะฒัะน ะพะฑัะฐะฑะพััะธะบ
โ   โ   โ   โโโ interface.go       # ะะฝัะตััะตะนัั
โ   โ   โโโ response/              # HTTP ะพัะฒะตัั
โ   โ   โ   โโโ response.go
โ   โ   โโโ router/                # ะะฐัััััะธะทะฐัะธั
โ   โ   โ   โโโ router.go
โ   โ   โโโ server/                # HTTP ัะตัะฒะตั
โ   โ       โโโ server.go
โ   โโโ cache/                     # ะััะธัะพะฒะฐะฝะธะต
โ   โ   โโโ redis.go
โ   โโโ config/                    # ะะพะฝัะธะณััะฐัะธั
โ   โ   โโโ config.go
โ   โ   โโโ types.go
โ   โโโ model/                     # ะะพะดะตะปะธ ะดะฐะฝะฝัั
โ   โ   โโโ model.go
โ   โโโ repository/                # ะกะปะพะน ะดะฐะฝะฝัั
โ   โ   โโโ create.go             # ะกะพะทะดะฐะฝะธะต ะทะฐะฟะธัะตะน
โ   โ   โโโ get.go                # ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั
โ   โ   โโโ repo.go               # ะะฐะทะพะฒัะน ัะตะฟะพะทะธัะพัะธะน
โ   โโโ service/                   # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ       โโโ create.go             # ะกะพะทะดะฐะฝะธะต ัััะปะพะบ
โ       โโโ get.go                # ะะพะปััะตะฝะธะต ัััะปะพะบ
โ       โโโ interface.go          # ะะฝัะตััะตะนัั ัะตัะฒะธัะพะฒ
โ       โโโ service.go            # ะะฐะทะพะฒัะน ัะตัะฒะธั
โ       โโโ utils.go              # ะฃัะธะปะธัั
โโโ migrations/                    # SQL ะผะธะณัะฐัะธะธ
โ   โโโ 20250929154354_create_table_urls.sql
โ   โโโ 20250929155733_create_table_redirect_analytics.sql
โโโ web/                          # ะคัะพะฝัะตะฝะด
โ   โโโ index.html                # ะะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ
โ   โโโ analytics.html            # ะกััะฐะฝะธัะฐ ะฐะฝะฐะปะธัะธะบะธ
โ   โโโ app.js                    # JS ะดะปั ะณะปะฐะฒะฝะพะน ัััะฐะฝะธัั
โ   โโโ analytics.js              # JS ะดะปั ะฐะฝะฐะปะธัะธะบะธ
โ   โโโ styles.css                # ะกัะธะปะธ
โโโ docker-compose.yml            # Docker Compose ะบะพะฝัะธะณััะฐัะธั
โโโ Dockerfile                    # Docker ะพะฑัะฐะท
โโโ go.mod                        # Go ะผะพะดัะปะธ
โโโ go.sum                        # Go ะทะฐะฒะธัะธะผะพััะธ
```

## ๐๏ธ ะขะตัะฝะพะปะพะณะธะธ

### Backend
- **Go 1.24** - ะพัะฝะพะฒะฝะพะน ัะทัะบ
- **Gin** - HTTP ััะตะนะผะฒะพัะบ
- **PostgreSQL** - ะพัะฝะพะฒะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั
- **Redis** - ะบััะธัะพะฒะฐะฝะธะต
- **Goose** - ะผะธะณัะฐัะธะธ ะะ

### Frontend
- **Vanilla JavaScript** - ะฑะตะท ััะตะนะผะฒะพัะบะพะฒ
- **CSS3** - ัะพะฒัะตะผะตะฝะฝัะต ััะธะปะธ
- **Responsive Design** - ะฐะดะฐะฟัะธะฒะฝะฐั ะฒะตัััะบะฐ

## ๐ ะัััััะน ััะฐัั

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั
```bash
git clone <repository-url>
cd url-shortener
```

### 2. ะะฐะฟััะบ ั Docker Compose
```bash
# ะกะพะทะดะฐะฝะธะต .env ัะฐะนะปะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
cat > .env << EOF
DB_HOST=db
DB_PORT=5432
DB_USER=your_name
DB_PASSWORD=your_password
DB_NAME=url-shortener
GOOSE_DRIVER=postgres
GOOSE_MIGRATION_DIR=/migrations
REDIS_PASSWORD=redispass
EOF

# ะะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
docker compose up --build
```

### 3. ะะพัััะฟ ะบ ะฟัะธะปะพะถะตะฝะธั
- **ะะตะฑ-ะธะฝัะตััะตะนั**: http://localhost:8080
- **API**: http://localhost:8080/api/
- **PostgreSQL**: localhost:5432
- **Redis**: localhost:6379

## ๐ API ะะพะบัะผะตะฝัะฐัะธั

### ะกะพะทะดะฐะฝะธะต ะบะพัะพัะบะพะน ัััะปะบะธ
```http
POST /api/shorten
Content-Type: application/json

{
  "url": "https://example.com/very/long/url",
  "user_short_url": "my-custom-alias"  // ะพะฟัะธะพะฝะฐะปัะฝะพ
}
```

**ะัะฒะตั:**
```json
{
  "result": {
    "id": "uuid",
    "url": "https://example.com/very/long/url",
    "short_url": "abc123",
    "created_at": "2025-09-30T10:00:00Z"
  }
}
```

### ะะตัะตัะพะด ะฟะพ ะบะพัะพัะบะพะน ัััะปะบะต
```http
GET /s/{short_url}
```
**ะัะฒะตั:** HTTP 302 ัะตะดะธัะตะบั ะฝะฐ ะพัะธะณะธะฝะฐะปัะฝัะน URL

### ะะฝะฐะปะธัะธะบะฐ ะฟะตัะตัะพะดะพะฒ
```http
GET /api/analytics/{short_url}
```

**ะัะฒะตั:**
```json
{
  "result": {
    "short_url": "abc123",
    "total_clicks": 42,
    "daily": {
      "2025-09-30": 15,
      "2025-09-29": 27
    },
    "monthly": {
      "2025-09": 42
    },
    "user_agent": {
      "Mozilla/5.0...": 25,
      "Chrome/91.0...": 17
    }
  }
}
```

## ๐๏ธ ะะฐะทะฐ ะดะฐะฝะฝัั

### ะขะฐะฑะปะธัะฐ `urls`
```sql
CREATE TABLE urls (
    id SERIAL PRIMARY KEY,
    url TEXT NOT NULL,
    short_url VARCHAR(32) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### ะขะฐะฑะปะธัะฐ `analytics`
```sql
CREATE TABLE analytics (
    id SERIAL PRIMARY KEY,
    short_url VARCHAR(32) REFERENCES urls(short_url) ON DELETE CASCADE,
    user_agent TEXT,
    device_type VARCHAR(32),
    os VARCHAR(64),
    browser VARCHAR(64),
    ip_address INET,
    created_at TIMESTAMP DEFAULT NOW()
);
```

## ๐จ ะคัะพะฝัะตะฝะด

### ะะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ (`/`)
- ะกะพะทะดะฐะฝะธะต ะบะพัะพัะบะธั ัััะปะพะบ
- ะะฐััะพะผะฝัะต ะฐะปะธะฐัั
- ะะพะฟะธัะพะฒะฐะฝะธะต ัััะปะพะบ
- ะะตัะตัะพะด ะบ ะฐะฝะฐะปะธัะธะบะต

### ะกััะฐะฝะธัะฐ ะฐะฝะฐะปะธัะธะบะธ (`/analytics.html`)
- ะะฒะพะด ะฐะปะธะฐัะฐ ะดะปั ะฐะฝะฐะปะธะทะฐ
- ะกัะฐัะธััะธะบะฐ ะฟะตัะตัะพะดะพะฒ
- ะัะฐัะธะบะธ ะฟะพ ะดะฝัะผ/ะผะตัััะฐะผ
- ะขะฐะฑะปะธัะฐ ั ะดะตัะฐะปัะฝะพะน ะธะฝัะพัะผะฐัะธะตะน


### Docker Compose ัะตัะฒะธัั
- **shortener** - ะพัะฝะพะฒะฝะพะต ะฟัะธะปะพะถะตะฝะธะต
- **db** - PostgreSQL ะฑะฐะทะฐ ะดะฐะฝะฝัั
- **redis** - Redis ะบัั
- **migrator** - ะฒัะฟะพะปะฝะตะฝะธะต ะผะธะณัะฐัะธะน

## ๐ ะะฐะทะฒะตัััะฒะฐะฝะธะต

### ะัะพะดะฐะบัะฝ
1. ะะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
2. ะัะฟะพะปัะทัะนัะต ะฒะฝะตัะฝะธะต ะะ (PostgreSQL, Redis)
3. ะะฐัััะพะนัะต SSL/TLS
4. ะัะฟะพะปัะทัะนัะต reverse proxy (nginx)

### ะะพะฝะธัะพัะธะฝะณ
- ะะพะณะธ ะฟัะธะปะพะถะตะฝะธั ะฒ stdout
- ะะตััะธะบะธ PostgreSQL
- ะะพะฝะธัะพัะธะฝะณ Redis
- Health checks ะดะปั Docker

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ
```bash
# ะะฐะฟััะบ ัะพะปัะบะพ ะะ
docker compose up db redis

# ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั ะปะพะบะฐะปัะฝะพ
go run cmd/shortener/main.go
```

### ะขะตััะธัะพะฒะฐะฝะธะต API
```bash
# ะกะพะทะดะฐะฝะธะต ัััะปะบะธ
curl -X POST http://localhost:8080/api/shorten \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com"}'

# ะะพะปััะตะฝะธะต ะฐะฝะฐะปะธัะธะบะธ
curl http://localhost:8080/api/analytics/abc123
```

